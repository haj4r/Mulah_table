<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Table Processing</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>

<body>
    <main>
        <h1>Table Output & Processing</h1>

        <section>
            <h2>Table 1</h2>
            <div id="table1"></div>
        </section>

        <section>
            <h2>Table 2 (Processed)</h2>
            <div id="table2"></div>
        </section>
    </main>

    <script>
        let tableData = [];

        // Load bundled CSV
        window.addEventListener("DOMContentLoaded", () => {
            Papa.parse("https://drive.google.com/file/d/1_0lk9nzqiU1o1x879eUDJLiILz2Dylpd/view", {
                download: true,
                complete: function (results) {
                    tableData = results.data;
                    displayTable1();
                    displayTable2();
                }
            });
        });


        function displayTable1() {
            const container = document.getElementById("table1");
            container.innerHTML = "";

            const table = document.createElement("table");
            const thead = document.createElement("thead");
            const headRow = document.createElement("tr");

            tableData[0].forEach(h => {
                const th = document.createElement("th");
                th.textContent = h;
                headRow.appendChild(th);
            });

            thead.appendChild(headRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            for (let i = 1; i < tableData.length; i++) {
                if (tableData[i].length === 0) continue;
                const row = document.createElement("tr");
                tableData[i].forEach(cell => {
                    const td = document.createElement("td");
                    td.textContent = cell;
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            }
            table.appendChild(tbody);

            container.appendChild(table);
        }

        function displayTable2() {
            const container = document.getElementById("table2");
            container.innerHTML = "";

            if (tableData.length < 21) return;

            // Safely parse values from column 2 (index 1)
            const getVal = (rowIdx) => parseFloat(tableData[rowIdx]?.[1]) || 0;

            const alpha = getVal(5) + getVal(20);   // A5 + A20
            const beta = getVal(15) / (getVal(7) || 1); // A15 / A7
            const charlie = getVal(13) * getVal(12);    // A13 * A12

            const table = document.createElement("table");

            const thead = document.createElement("thead");
            const headRow = document.createElement("tr");
            ["Category", "Value"].forEach(h => {
                const th = document.createElement("th");
                th.textContent = h;
                headRow.appendChild(th);
            });
            thead.appendChild(headRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            [
                ["Alpha", alpha],
                ["Beta", beta],
                ["Charlie", charlie]
            ].forEach(([label, value]) => {
                const row = document.createElement("tr");
                const td1 = document.createElement("td");
                td1.textContent = label;
                const td2 = document.createElement("td");
                td2.textContent = Number.isInteger(value) ? value : value.toFixed(2);
                row.appendChild(td1);
                row.appendChild(td2);
                tbody.appendChild(row);
            });
            table.appendChild(tbody);

            container.appendChild(table);
        }
    </script>
</body>

</html>
