<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Table Processing</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>

<body>
  <main>
    <h1>Table Output & Processing</h1>

    <section>
      <h2>Table 1</h2>
      <div id="table1"></div>
    </section>

    <section>
      <h2>Table 2 (Processed)</h2>
      <div id="table2"></div>
    </section>
  </main>

  <script>
    let tableData = [];

    // Embed CSV directly as string
    const csvData = `
ID,Value
A1,10
A2,5
A3,8
A4,2
A5,15
A6,9
A7,3
A8,6
A9,12
A10,7
A11,4
A12,2
A13,5
A14,8
A15,20
A16,6
A17,14
A18,10
A19,11
A20,25
    `;

    window.addEventListener("DOMContentLoaded", () => {
      Papa.parse(csvData.trim(), {
        header: true,
        skipEmptyLines: true,
        complete: function (results) {
          tableData = results.data;
          displayTable1();
          displayTable2();
        }
      });
    });

    function displayTable1() {
      const container = document.getElementById("table1");
      container.innerHTML = "";

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      const headRow = document.createElement("tr");

      Object.keys(tableData[0]).forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        headRow.appendChild(th);
      });

      thead.appendChild(headRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      tableData.forEach(rowData => {
        const row = document.createElement("tr");
        Object.values(rowData).forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          row.appendChild(td);
        });
        tbody.appendChild(row);
      });

      table.appendChild(tbody);
      container.appendChild(table);
    }

    function displayTable2() {
      const container = document.getElementById("table2");
      container.innerHTML = "";

      const getVal = (id) => {
        const entry = tableData.find(r => r.ID === id);
        return entry ? parseFloat(entry.Value) : 0;
      };

      const alpha = getVal("A5") + getVal("A20");
      const beta = getVal("A15") / (getVal("A7") || 1);
      const charlie = getVal("A13") * getVal("A12");

      const table = document.createElement("table");

      const thead = document.createElement("thead");
      const headRow = document.createElement("tr");
      ["Category", "Value"].forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        headRow.appendChild(th);
      });
      thead.appendChild(headRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      [
        ["Alpha", alpha],
        ["Beta", beta],
        ["Charlie", charlie]
      ].forEach(([label, value]) => {
        const row = document.createElement("tr");
        const td1 = document.createElement("td");
        td1.textContent = label;
        const td2 = document.createElement("td");
        td2.textContent = Number.isInteger(value) ? value : value.toFixed(2);
        row.appendChild(td1);
        row.appendChild(td2);
        tbody.appendChild(row);
      });
      table.appendChild(tbody);

      container.appendChild(table);
    }
  </script>
</body>
</html>
